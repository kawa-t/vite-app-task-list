var Ve=Object.defineProperty;var Ke=(t,e,n)=>e in t?Ve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var g=(t,e,n)=>(Ke(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();const Ge="/vite-app-task-list/assets/typescript-f6ead1af.svg";class qe{constructor(){g(this,"listeners",{})}addTask(e,n,r,a){this.listeners[e]={event:n,element:r,handler:a},r.addEventListener(n,a)}removeTask(e){const n=this.listeners[e];!n||(n.element.removeEventListener(n.event,n.handler),delete this.listeners[e])}}let $;const ze=new Uint8Array(16);function Je(){if(!$&&($=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!$))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $(ze)}const We=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Qe(t){return typeof t=="string"&&We.test(t)}const h=[];for(let t=0;t<256;++t)h.push((t+256).toString(16).slice(1));function Ze(t,e=0){return(h[t[e+0]]+h[t[e+1]]+h[t[e+2]]+h[t[e+3]]+"-"+h[t[e+4]]+h[t[e+5]]+"-"+h[t[e+6]]+h[t[e+7]]+"-"+h[t[e+8]]+h[t[e+9]]+"-"+h[t[e+10]]+h[t[e+11]]+h[t[e+12]]+h[t[e+13]]+h[t[e+14]]+h[t[e+15]]).toLowerCase()}const et=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),me={randomUUID:et};function tt(t,e,n){if(me.randomUUID&&!e&&!t)return me.randomUUID();t=t||{};const r=t.random||(t.rng||Je)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let a=0;a<16;++a)e[n+a]=r[a];return e}return Ze(r)}const w={Todo:"Todo",InProgress:"InProgress",Done:"Done"};class te{constructor(e){g(this,"taskId");g(this,"title");g(this,"status");this.taskId=e.taskId||tt(),this.title=e.title,this.status=e.status||w.Todo}static validateTaskList(e){return!(!e||!Qe(e.taskId)||typeof e.title!="string"&&!e.title||!Object.values(w).includes(e.status))}updateStatus(e){this.title=e.title||this.title,this.status=e.status||this.status}}const Q="TASK_LIST";class nt{constructor(){g(this,"taskStorage");g(this,"taskList");this.taskStorage=localStorage,this.taskList=this.getStoredTaskList()}updateStorage(){this.taskStorage.setItem(Q,JSON.stringify(this.taskList))}getStoredTaskList(){try{const e=this.taskStorage.getItem(Q);if(!e)return[];const n=JSON.parse(e);return rt(n),n.map(a=>new te(a))}catch{return this.taskStorage.removeItem(Q),[]}}changeOrder(e,n,r){this.taskList.splice(n,1),this.taskList.splice(r,0,e),this.updateStorage()}addTask(e){this.taskList.push(e),this.updateStorage()}delete(e){this.taskList=this.taskList.filter(({taskId:n})=>n!==e.taskId),this.updateStorage()}findTask(e){return this.taskList.find(n=>n.taskId===e)}updateTask(e){this.taskList=this.taskList.map(n=>n.taskId===e.taskId?e:n)}filterTask(e){return this.taskList.filter(({status:n})=>n===e)}moveAboveTarget(e,n){const r=this.taskList.indexOf(e),a=this.taskList.indexOf(n);this.changeOrder(e,r,r<a?a-1:a)}moveToLast(e){const n=this.taskList.indexOf(e);this.changeOrder(e,n,this.taskList.length)}}function rt(t){if(!Array.isArray(t)||!t.every(e=>te.validateTaskList(e)))throw new Error(`引数${t}に問題があるよ`)}var it=function(e,n){return Array.prototype.slice.call(e,n)},at=typeof setImmediate=="function",ee;at?ee=function(t){setImmediate(t)}:ee=function(t){setTimeout(t,0)};var st=ee,ot=st,lt=function(e,n,r){!e||ot(function(){e.apply(r||null,n||[])})},he=it,ut=lt,ct=function(e,n){var r=n||{},a={};return e===void 0&&(e={}),e.on=function(s,c){return a[s]?a[s].push(c):a[s]=[c],e},e.once=function(s,c){return c._once=!0,e.on(s,c),e},e.off=function(s,c){var k=arguments.length;if(k===1)delete a[s];else if(k===0)a={};else{var C=a[s];if(!C)return e;C.splice(C.indexOf(c),1)}return e},e.emit=function(){var s=he(arguments);return e.emitterSnapshot(s.shift()).apply(this,s)},e.emitterSnapshot=function(s){var c=(a[s]||[]).slice(0);return function(){var k=he(arguments),C=this||e;if(s==="error"&&r.throws!==!1&&!c.length)throw k.length===1?k[0]:k;return c.forEach(function(y){r.async?ut(y,k,C):y.apply(C,k),y._once&&e.off(s,y)}),e}},e},ye=window.CustomEvent;function dt(){try{var t=new ye("cat",{detail:{foo:"bar"}});return t.type==="cat"&&t.detail.foo==="bar"}catch{}return!1}var vt=dt()?ye:typeof document<"u"&&typeof document.createEvent=="function"?function(e,n){var r=document.createEvent("CustomEvent");return n?r.initCustomEvent(e,n.bubbles,n.cancelable,n.detail):r.initCustomEvent(e,!1,!1,void 0),r}:function(e,n){var r=document.createEventObject();return r.type=e,n?(r.bubbles=Boolean(n.bubbles),r.cancelable=Boolean(n.cancelable),r.detail=n.detail):(r.bubbles=!1,r.cancelable=!1,r.detail=void 0),r},Se=[],Z="",ft=/^on/;for(Z in window)ft.test(Z)&&Se.push(Z.slice(2));var mt=Se,ht=vt,pt=mt,F=window.document,Ce=kt,Ie=Et,U=[];window.addEventListener||(Ce=Tt,Ie=bt);var gt={add:Ce,remove:Ie,fabricate:Lt};function kt(t,e,n,r){return t.addEventListener(e,n,r)}function Tt(t,e,n){return t.attachEvent("on"+e,yt(t,e,n))}function Et(t,e,n,r){return t.removeEventListener(e,n,r)}function bt(t,e,n){var r=De(t,e,n);if(r)return t.detachEvent("on"+e,r)}function Lt(t,e,n){var r=pt.indexOf(e)===-1?s():a();t.dispatchEvent?t.dispatchEvent(r):t.fireEvent("on"+e,r);function a(){var c;return F.createEvent?(c=F.createEvent("Event"),c.initEvent(e,!0,!0)):F.createEventObject&&(c=F.createEventObject()),c}function s(){return new ht(e,{detail:n})}}function wt(t,e,n){return function(a){var s=a||window.event;s.target=s.target||s.srcElement,s.preventDefault=s.preventDefault||function(){s.returnValue=!1},s.stopPropagation=s.stopPropagation||function(){s.cancelBubble=!0},s.which=s.which||s.keyCode,n.call(t,s)}}function yt(t,e,n){var r=De(t,e,n)||wt(t,e,n);return U.push({wrapper:r,element:t,type:e,fn:n}),r}function De(t,e,n){var r=St(t,e,n);if(r){var a=U[r].wrapper;return U.splice(r,1),a}}function St(t,e,n){var r,a;for(r=0;r<U.length;r++)if(a=U[r],a.element===t&&a.type===e&&a.fn===n)return r}var pe={},Ct="(?:^|\\s)",It="(?:\\s|$)";function Oe(t){var e=pe[t];return e?e.lastIndex=0:pe[t]=e=new RegExp(Ct+t+It,"g"),e}function Dt(t,e){var n=t.className;n.length?Oe(e).test(n)||(t.className+=" "+e):t.className=e}function Ot(t,e){t.className=t.className.replace(Oe(e)," ").trim()}var xt={add:Dt,rm:Ot},At=ct,_=gt,O=xt,M=document,S=M.documentElement;function Bt(t,e){var n=arguments.length;n===1&&Array.isArray(t)===!1&&(e=t,t=[]);var r,a,s,c,k,C,j,y,R,f,H,A=null,P,l=e||{};l.moves===void 0&&(l.moves=Ee),l.accepts===void 0&&(l.accepts=Ee),l.invalid===void 0&&(l.invalid=Me),l.containers===void 0&&(l.containers=t||[]),l.isContainer===void 0&&(l.isContainer=Nt),l.copy===void 0&&(l.copy=!1),l.copySortSource===void 0&&(l.copySortSource=!1),l.revertOnSpill===void 0&&(l.revertOnSpill=!1),l.removeOnSpill===void 0&&(l.removeOnSpill=!1),l.direction===void 0&&(l.direction="vertical"),l.ignoreInputTextSelection===void 0&&(l.ignoreInputTextSelection=!0),l.mirrorContainer===void 0&&(l.mirrorContainer=M.body);var v=At({containers:l.containers,start:_e,end:se,cancel:ce,remove:ue,destroy:Ae,canMove:Ne,dragging:!1});return l.removeOnSpill===!0&&v.on("over",Pe).on("out",Xe),ne(),v;function V(i){return v.containers.indexOf(i)!==-1||l.isContainer(i)}function ne(i){var o=i?"remove":"add";X(S,o,"mousedown",Be),X(S,o,"mouseup",q)}function K(i){var o=i?"remove":"add";X(S,o,"mousemove",Re)}function re(i){var o=i?"remove":"add";_[o](S,"selectstart",ie),_[o](S,"click",ie)}function Ae(){ne(!0),q({})}function ie(i){P&&i.preventDefault()}function Be(i){C=i.clientX,j=i.clientY;var o=ge(i)!==1||i.metaKey||i.ctrlKey;if(!o){var u=i.target,d=G(u);!d||(P=d,K(),i.type==="mousedown"&&(we(u)?u.focus():i.preventDefault()))}}function Re(i){if(!!P){if(ge(i)===0){q({});return}if(!(i.clientX!==void 0&&Math.abs(i.clientX-C)<=(l.slideFactorX||0)&&i.clientY!==void 0&&Math.abs(i.clientY-j)<=(l.slideFactorY||0))){if(l.ignoreInputTextSelection){var o=x("clientX",i)||0,u=x("clientY",i)||0,d=M.elementFromPoint(o,u);if(we(d))return}var T=P;K(!0),re(),se(),ae(T);var m=Rt(s);c=x("pageX",i)-m.left,k=x("pageY",i)-m.top,O.add(f||s,"gu-transit"),Ye(),W(i)}}}function G(i){if(!(v.dragging&&r)&&!V(i)){for(var o=i;E(i)&&V(E(i))===!1;)if(l.invalid(i,o)||(i=E(i),!i))return;var u=E(i);if(!!u&&!l.invalid(i,o)){var d=l.moves(i,u,o,Y(i));if(!!d)return{item:i,source:u}}}}function Ne(i){return!!G(i)}function _e(i){var o=G(i);o&&ae(o)}function ae(i){$e(i.item,i.source)&&(f=i.item.cloneNode(!0),v.emit("cloned",f,i.item,"copy")),a=i.source,s=i.item,y=R=Y(i.item),v.dragging=!0,v.emit("drag",s,a)}function Me(){return!1}function se(){if(!!v.dragging){var i=f||s;le(i,E(i))}}function oe(){P=!1,K(!0),re(!0)}function q(i){if(oe(),!!v.dragging){var o=f||s,u=x("clientX",i)||0,d=x("clientY",i)||0,T=Te(r,u,d),m=de(T,u,d);m&&(f&&l.copySortSource||!f||m!==a)?le(o,m):l.removeOnSpill?ue():ce()}}function le(i,o){var u=E(i);f&&l.copySortSource&&o===a&&u.removeChild(s),J(o)?v.emit("cancel",i,a,a):v.emit("drop",i,o,a,R),z()}function ue(){if(!!v.dragging){var i=f||s,o=E(i);o&&o.removeChild(i),v.emit(f?"cancel":"remove",i,o,a),z()}}function ce(i){if(!!v.dragging){var o=arguments.length>0?i:l.revertOnSpill,u=f||s,d=E(u),T=J(d);T===!1&&o&&(f?d&&d.removeChild(f):a.insertBefore(u,y)),T||o?v.emit("cancel",u,a,a):v.emit("drop",u,d,a,R),z()}}function z(){var i=f||s;oe(),Ue(),i&&O.rm(i,"gu-transit"),H&&clearTimeout(H),v.dragging=!1,A&&v.emit("out",i,A,a),v.emit("dragend",i),a=s=f=y=R=H=A=null}function J(i,o){var u;return o!==void 0?u=o:r?u=R:u=Y(f||s),i===a&&u===y}function de(i,o,u){for(var d=i;d&&!T();)d=E(d);return d;function T(){var m=V(d);if(m===!1)return!1;var N=ve(d,i),p=fe(d,N,o,u),I=J(d,p);return I?!0:l.accepts(s,d,a,p)}}function W(i){if(!r)return;i.preventDefault();var o=x("clientX",i)||0,u=x("clientY",i)||0,d=o-c,T=u-k;r.style.left=d+"px",r.style.top=T+"px";var m=f||s,N=Te(r,o,u),p=de(N,o,u),I=p!==null&&p!==A;(I||p===null)&&(je(),A=p,Fe());var b=E(m);if(p===a&&f&&!l.copySortSource){b&&b.removeChild(m);return}var L,B=ve(p,N);if(B!==null)L=fe(p,B,o,u);else if(l.revertOnSpill===!0&&!f)L=y,p=a;else{f&&b&&b.removeChild(m);return}(L===null&&I||L!==m&&L!==Y(m))&&(R=L,p.insertBefore(m,L),v.emit("shadow",m,p,a));function D(He){v.emit(He,m,A,a)}function Fe(){I&&D("over")}function je(){A&&D("out")}}function Pe(i){O.rm(i,"gu-hide")}function Xe(i){v.dragging&&O.add(i,"gu-hide")}function Ye(){if(!r){var i=s.getBoundingClientRect();r=s.cloneNode(!0),r.style.width=be(i)+"px",r.style.height=Le(i)+"px",O.rm(r,"gu-transit"),O.add(r,"gu-mirror"),l.mirrorContainer.appendChild(r),X(S,"add","mousemove",W),O.add(l.mirrorContainer,"gu-unselectable"),v.emit("cloned",r,s,"mirror")}}function Ue(){r&&(O.rm(l.mirrorContainer,"gu-unselectable"),X(S,"remove","mousemove",W),E(r).removeChild(r),r=null)}function ve(i,o){for(var u=o;u!==i&&E(u)!==i;)u=E(u);return u===S?null:u}function fe(i,o,u,d){var T=l.direction==="horizontal",m=o!==i?p():N();return m;function N(){var b=i.children.length,L,B,D;for(L=0;L<b;L++)if(B=i.children[L],D=B.getBoundingClientRect(),T&&D.left+D.width/2>u||!T&&D.top+D.height/2>d)return B;return null}function p(){var b=o.getBoundingClientRect();return I(T?u>b.left+be(b)/2:d>b.top+Le(b)/2)}function I(b){return b?Y(o):o}}function $e(i,o){return typeof l.copy=="boolean"?l.copy:l.copy(i,o)}}function X(t,e,n,r){var a={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},s={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},c={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};window.navigator.pointerEnabled?_[e](t,s[n],r):window.navigator.msPointerEnabled?_[e](t,c[n],r):(_[e](t,a[n],r),_[e](t,n,r))}function ge(t){if(t.touches!==void 0)return t.touches.length;if(t.which!==void 0&&t.which!==0)return t.which;if(t.buttons!==void 0)return t.buttons;var e=t.button;if(e!==void 0)return e&1?1:e&2?3:e&4?2:0}function Rt(t){var e=t.getBoundingClientRect();return{left:e.left+ke("scrollLeft","pageXOffset"),top:e.top+ke("scrollTop","pageYOffset")}}function ke(t,e){return typeof window[e]<"u"?window[e]:S.clientHeight?S[t]:M.body[t]}function Te(t,e,n){t=t||{};var r=t.className||"",a;return t.className+=" gu-hide",a=M.elementFromPoint(e,n),t.className=r,a}function Nt(){return!1}function Ee(){return!0}function be(t){return t.width||t.right-t.left}function Le(t){return t.height||t.bottom-t.top}function E(t){return t.parentNode===M?null:t.parentNode}function we(t){return t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.tagName==="SELECT"||xe(t)}function xe(t){return!t||t.contentEditable==="false"?!1:t.contentEditable==="true"?!0:xe(E(t))}function Y(t){return t.nextElementSibling||e();function e(){var n=t;do n=n.nextSibling;while(n&&n.nodeType!==1);return n}}function _t(t){return t.targetTouches&&t.targetTouches.length?t.targetTouches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t}function x(t,e){var n=_t(e),r={pageX:"clientX",pageY:"clientY"};return t in r&&!(t in n)&&r[t]in n&&(t=r[t]),n[t]}var Mt=Bt;class Pt{constructor(e,n,r){this.todoTaskList=e,this.doingTaskList=n,this.doneTaskList=r}renderAll(e){const n=this.renderList(e.filterTask(w.Todo),this.todoTaskList),r=this.renderList(e.filterTask(w.InProgress),this.doingTaskList),a=this.renderList(e.filterTask(w.Done),this.doneTaskList);return[...n,...r,...a]}append(e){const{taskElement:n,deleteButtonElement:r}=this.render(e);return this.todoTaskList.append(n),{deleteButtonElement:r}}remove(e){const n=document.getElementById(e.taskId);!n||(e.status===w.Todo&&this.todoTaskList.removeChild(n),e.status===w.InProgress&&this.doingTaskList.removeChild(n),e.status===w.Done&&this.doneTaskList.removeChild(n))}render(e){const n=document.createElement("div"),r=document.createElement("span"),a=document.createElement("button");return n.id=e.taskId,n.classList.add("task-item"),r.textContent=e.title,a.textContent="削除",n.append(r,a),{taskElement:n,deleteButtonElement:a}}renderList(e,n){if(e.length===0)return[];const r=[];return e.forEach(a=>{const{taskElement:s,deleteButtonElement:c}=this.render(a);n.append(s),r.push({task:a,deleteButtonElement:c})}),r}subscribeDragAndDrop(e){Mt([this.todoTaskList,this.doingTaskList,this.doneTaskList]).on("drop",(n,r,a)=>{let s=w.Todo;r.id==="doingTaskList"&&(s=w.InProgress),r.id==="doneTaskList"&&(s=w.Done),e(n,a,s)})}getTaskId(e){return e.id}}class Xt{constructor(){g(this,"eventListenTask",new qe);g(this,"taskCollection",new nt);g(this,"taskRender",new Pt(document.getElementById("todoTaskList"),document.getElementById("doingTaskList"),document.getElementById("doneTaskList")));g(this,"executeDeleteTask",e=>{this.eventListenTask.removeTask(e.taskId),this.taskCollection.delete(e),this.taskRender.remove(e)});g(this,"handleSubmit",e=>{e.preventDefault();const n=document.getElementById("title");if(!n.value)return;const r=new te({title:n.value});this.taskCollection.addTask(r);const{deleteButtonElement:a}=this.taskRender.append(r);this.eventListenTask.addTask(r.taskId,"click",a,()=>{this.handleClickDeleteTask(r)}),n.value=""});g(this,"handleClickDeleteTask",e=>{!window.confirm(`${e.title}を削除してもいいですか`)||(this.eventListenTask.removeTask(e.taskId),this.taskCollection.delete(e),this.taskRender.remove(e),this.executeDeleteTask(e))});g(this,"handleDropAndDrop",(e,n,r)=>{const a=this.taskRender.getTaskId(e);if(!a)return;const s=this.taskCollection.findTask(a);if(!!s)if(s.updateStatus({status:r}),this.taskCollection.updateTask(s),n){const c=this.taskRender.getTaskId(e);if(!c)return;const k=this.taskCollection.findTask(c);if(!k)return;this.taskCollection.moveAboveTarget(s,k)}else this.taskCollection.moveToLast(s)});g(this,"handleClickDeleteAllDoneTasks",()=>{if(!window.confirm("完了したタスクを全て削除しますか？"))return;this.taskCollection.filterTask(w.Done).forEach(n=>this.executeDeleteTask(n))})}start(){console.log("Application started");const e=this.taskRender.renderAll(this.taskCollection),n=document.getElementById("createForm"),r=document.getElementById("deleteAllDoneTask");e.forEach(({task:a,deleteButtonElement:s})=>{this.eventListenTask.addTask(a.taskId,"click",s,()=>this.handleClickDeleteTask(a))}),this.eventListenTask.addTask("submit-handler","submit",n,this.handleSubmit),this.eventListenTask.addTask("click-handler","click",r,this.handleClickDeleteAllDoneTasks),this.taskRender.subscribeDragAndDrop(this.handleDropAndDrop)}}window.addEventListener("load",()=>{new Xt().start()});document.querySelector("#app").innerHTML=`
  <div>
    <a href="https://vitejs.dev" target="_blank">
      <img src="/vite.svg" class="logo" alt="Vite logo" />
    </a>
    <a href="https://www.typescriptlang.org/" target="_blank">
      <img src="${Ge}" class="logo vanilla" alt="TypeScript logo" />
    </a>
    <h1>Vite + TypeScript</h1>
  </div>
  <div class="container">
    <h1 class="title">list education</h1>

    <form id="createForm" class="new">
      <div class="new-head">
        <h2 class="new-title">タスクを新規作成</h2>
        <button class="new-button">作成</button>
      </div>

      <label class="new-label" for="title">タイトル</label>
      <input id="title" class="new-input" name="title" />
    </form>

    <div class="lane">
      <div class="lane-item">
        <div class="lane-item-inner">
          <div class="lane-status">
            <p class="lane-status-name">TODO</p>
          </div>

          <div id="todoTaskList" class="tasks"></div>
        </div>
      </div>

      <div class="lane-item">
        <div class="lane-item-inner">
          <div class="lane-status">
            <p class="lane-status-name">DOING</p>
          </div>

          <div id="doingTaskList" class="tasks"></div>
        </div>
      </div>

      <div class="lane-item">
        <div class="lane-item-inner">
          <div class="lane-status">
            <p class="lane-status-name">DONE</p>
            <button id="deleteAllDoneTask" class="lane-status-delete">DONE のタスクを一括削除</button>
          </div>

          <div id="doneTaskList" class="tasks"></div>
        </div>
      </div>
    </div>
  </div>
`;
